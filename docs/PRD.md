# PRD: 출입국 심사관 배치 자동화 시스템 (Immigration Queue Manager)

## 1. 개요

### 1.1 프로젝트 목적
출입국 심사장의 "줄반장"이 수행하는 심사관 배치 업무를 자동화하여, 승객 대기시간을 최소화하면서 인력을 효율적으로 운용하는 **웹 기반 시스템**을 구축한다.

### 1.2 배경 및 현황
현재 줄반장은 다음과 같은 방식으로 업무를 수행한다:
- 항공편 스케줄을 눈으로 확인하며 승객 수 예측
- 경험과 감에 의존한 심사관 배치 결정
- 실시간 상황 변화에 수동 대응
- 근무표를 수기 또는 엑셀로 작성

이로 인한 문제점:
- 예측 정확도가 개인 역량에 의존
- 피크 타임 대응 지연으로 승객 불만 발생
- 비효율적 인력 운용 (과잉/과소 배치)
- 줄반장 부재 시 업무 공백
- **현장에서 PC 없이 확인 불가**

### 1.3 핵심 데이터 소스: 인천공항 공항 예상혼잡도
인천공항은 공식 웹사이트(https://www.airport.kr/ap_ko/883/subview.do)를 통해 **시간대별 출입국 승객 예고 현황**을 제공한다.

#### 제공 데이터
| 데이터 | 내용 | 업데이트 주기 |
|--------|------|---------------|
| 실시간 대기시간 | 출국장별(2~5번) 동편/서편 혼잡도 (원활/보통/혼잡/매우혼잡) | 실시간 |
| 출입국 승객 예고 | 1시간 단위, 입국장(A,B/C/D/E,F) 및 출국장(1,2/3/4/5,6)별 예상 승객 수 | 매일 17:00 |
| 예고 범위 | D+2일: 출국 예상혼잡도 / D+1일: 출입국 및 환승 예상혼잡도 | - |

#### 데이터 구조 예시
```
시간    | 입국장                      | 출국장
       | A,B  | C   | D   | E,F  | 합계 | 1,2  | 3    | 4    | 5,6  | 합계
07~08시| 1539 | 348 | 352 | 2334 | 4573 | 2145 | 1327 | 1079 | 1419 | 5970
08~09시| 1265 | 37  | 37  | 1410 | 2749 | 1586 | 1457 | 1149 | 1717 | 5909
```

#### 활용 방안
1. **λ(t) 직접 획득**: 승객 유입량 예측 계산 불필요, 공항 제공 데이터 그대로 사용
2. **구역별 배치 계산**: 입국장 4개 구역, 출국장 4개 구역별 세분화된 인원 계산 가능
3. **사전 계획 수립**: D+1, D+2 데이터로 근무표 사전 생성
4. **실시간 모니터링**: 혼잡도 상태로 예측 vs 실제 괴리 감지

### 1.4 프로젝트 범위
**Phase 1 (MVP)**: 인천공항 데이터 기반 시간대별 필요 인원 계산 (웹 앱)
**Phase 2**: 실제 근무표 자동 생성 + 실시간 대시보드
**Phase 3**: 백엔드 서버 연동 + 다중 사용자 지원

### 1.5 플랫폼 요구사항
| 항목 | 요구사항 |
|------|----------|
| 플랫폼 | 반응형 웹 애플리케이션 (HTML/CSS/JavaScript) |
| 지원 기기 | 데스크톱, 태블릿, **스마트폰** |
| 브라우저 | Chrome, Safari, Edge (최신 버전) |
| 오프라인 | PWA 지원으로 오프라인에서도 기본 기능 사용 |
| 데이터 저장 | Phase 1: LocalStorage / IndexedDB, Phase 3: 서버 DB |

---

## 2. 사용자 및 이해관계자

### 2.1 주요 사용자
| 사용자 | 역할 | 니즈 | 주 사용 기기 |
|--------|------|------|-------------|
| 줄반장 | 심사관 배치 결정, 근무표 관리 | 정확한 예측, 빠른 의사결정 지원 | **스마트폰**, 태블릿 |
| 심사관 | 지정된 위치에서 심사 수행 | 명확한 근무 스케줄 확인 | 스마트폰 |
| 관리자 | 전체 운영 감독 | 운영 효율성 지표, 리포트 | 데스크톱, 태블릿 |

### 2.2 사용 시나리오
1. **현장 순회 중 확인**: 줄반장이 심사장을 돌아다니며 스마트폰으로 예측 현황 확인
2. **교대 시간 전 계획**: 다음 교대 시간의 필요 인원을 미리 확인
3. **긴급 상황 대응**: 갑작스러운 항공편 지연/결항 시 즉시 재계산
4. **일일 리포트 확인**: 관리자가 PC에서 상세 분석 및 리포트 조회
5. **익일/익익일 계획**: 매일 17시 업데이트되는 예고 데이터로 사전 근무표 작성

---

## 3. 기능 요구사항

### 3.1 Phase 1: 예측 및 계산 엔진 (MVP) - 단일 페이지 웹 앱

#### FR-1.1 데이터 입력 관리
- **FR-1.1.1**: 인천공항 승객 예고 데이터 수동 입력 (테이블 형식)
- **FR-1.1.2**: CSV/Excel 파일 불러오기 (데스크톱)
- **FR-1.1.3**: 웹 크롤링을 통한 자동 데이터 수집 (선택적)
- **FR-1.1.4**: 샘플 데이터 제공 (데모용)
- **FR-1.1.5**: LocalStorage에 데이터 저장/불러오기

#### FR-1.2 승객 유입량 표시 (λ(t))
- **FR-1.2.1**: 인천공항 제공 시간대별 승객 수 표시
  - 입국: A,B / C / D / E,F 구역별
  - 출국: 1,2 / 3 / 4 / 5,6 구역별
- **FR-1.2.2**: 합계 및 구역별 데이터 토글 표시
- **FR-1.2.3**: 시간대별 피크 구간 하이라이트

#### FR-1.3 필요 심사관 수 계산 (c(t))
- **FR-1.3.1**: 심사 속도(μ) 파라미터 설정
  - 카테고리별: 내국인 입국, 외국인 입국, 내국인 출국, 외국인 출국
  - 전자게이트 처리 속도
  - 슬라이더/입력으로 조정 가능
- **FR-1.3.2**: 대기행렬 모델 기반 계산
  - 목표 대기시간(W_max) 설정: 기본 15분
  - 목표 활용률(ρ_max) 설정: 기본 0.85
  - 계산식: c(t) = ceil(λ(t) / (ρ_max × μ))
- **FR-1.3.3**: 구역별 필요 심사관 수 출력
  - 입국장 4개 구역 + 출국장 4개 구역
- **FR-1.3.4**: 전자게이트 vs 유인부스 비율 설정
  - 전자게이트 이용률 고려한 유인부스 필요 인원 보정

#### FR-1.4 결과 시각화 (모바일 최적화)
- **FR-1.4.1**: 시간대별 예상 승객 수 차트 (막대/라인)
- **FR-1.4.2**: 시간대별 필요 심사관 수 오버레이
- **FR-1.4.3**: 구역별 히트맵 (색상으로 혼잡도 표시)
- **FR-1.4.4**: 피크 시간 경고 표시
- **FR-1.4.5**: 카드 형태의 요약 정보
  - 금일 총 입국/출국 예상
  - 최대 피크 시간 및 필요 인원
  - 현재 시간대 필요 인원

#### FR-1.5 혼잡도 경보 체계
- **FR-1.5.1**: 인천공항 경보 기준 표시
  - BLUE: 시간당 7,000~7,600명
  - YELLOW: 시간당 7,600~8,200명 또는 7,600명 초과 연속 2시간
  - ORANGE: 시간당 8,200~8,600명 또는 7,600명 초과 연속 2시간
  - RED: 시간당 8,600명 이상 또는 8,200명 초과 연속 2시간
- **FR-1.5.2**: 경보 시간대 하이라이트 및 알림

#### FR-1.6 데이터 내보내기
- **FR-1.6.1**: CSV 다운로드 (시간대별 필요 인원표)
- **FR-1.6.2**: 화면 캡처/공유 (모바일)
- **FR-1.6.3**: 인쇄용 요약 리포트 생성

### 3.2 Phase 2: 근무표 및 대시보드

#### FR-2.1 심사관 관리
- **FR-2.1.1**: 심사관 등록/수정/삭제
- **FR-2.1.2**: 포지션별 자격 관리 (외국인 심사 가능 등)
- **FR-2.1.3**: 근무 가능 시간 설정

#### FR-2.2 근무표 생성
- **FR-2.2.1**: c(t) 기반 자동 배치 추천
- **FR-2.2.2**: 근무 제약조건 적용
  - 연속 근무시간 제한 (2시간)
  - 휴게시간 (10~15분)
  - 일 총 근무시간 (8시간)
- **FR-2.2.3**: 드래그 앤 드롭 수정 (데스크톱)
- **FR-2.2.4**: 탭/스와이프 수정 (모바일)

#### FR-2.3 실시간 대시보드
- **FR-2.3.1**: 현재 배치 현황 vs 권장 인원 비교
- **FR-2.3.2**: 향후 3시간 예측 타임라인
- **FR-2.3.3**: 실시간 혼잡도 상태 표시
- **FR-2.3.4**: 인원 과부족 경보 알림 (푸시)

### 3.3 Phase 3: 서버 연동

#### FR-3.1 백엔드 API
- **FR-3.1.1**: RESTful API 서버
- **FR-3.1.2**: 사용자 인증
- **FR-3.1.3**: 데이터 동기화

#### FR-3.2 자동 데이터 수집
- **FR-3.2.1**: 인천공항 데이터 주기적 크롤링 (17:00)
- **FR-3.2.2**: 실시간 혼잡도 수집 (5분 간격)
- **FR-3.2.3**: 과거 데이터 축적 및 분석

#### FR-3.3 실시간 기능
- **FR-3.3.1**: WebSocket 기반 실시간 업데이트
- **FR-3.3.2**: 다중 사용자 동시 접속

---

## 4. 비기능 요구사항

### 4.1 성능
- **NFR-1**: 초기 로딩 3초 이내 (3G 네트워크 기준)
- **NFR-2**: 필요 인원 계산 500ms 이내 (24시간 × 8구역)
- **NFR-3**: 부드러운 60fps 애니메이션

### 4.2 사용성 (모바일 중심)
- **NFR-4**: 한 손 조작 가능한 UI 배치
- **NFR-5**: 최소 44px 터치 타겟
- **NFR-6**: 다크 모드 지원 (야간/실내 사용)
- **NFR-7**: 큰 글씨 옵션 (현장 가독성)

### 4.3 반응형 디자인
- **NFR-8**: 모바일 (360px~767px): 세로 스크롤 중심, 카드 UI
- **NFR-9**: 태블릿 (768px~1023px): 2컬럼 레이아웃
- **NFR-10**: 데스크톱 (1024px~): 3컬럼, 상세 테이블

### 4.4 오프라인 지원 (PWA)
- **NFR-11**: Service Worker로 오프라인 캐싱
- **NFR-12**: 홈 화면 추가 가능
- **NFR-13**: 오프라인 시 마지막 데이터로 동작

### 4.5 접근성
- **NFR-14**: WCAG 2.1 AA 준수
- **NFR-15**: 스크린 리더 지원
- **NFR-16**: 고대비 모드

---

## 5. UI/UX 요구사항

### 5.1 디자인 원칙
1. **Mobile-First**: 모바일 화면부터 설계 후 확장
2. **한눈에 파악**: 핵심 정보를 즉시 확인 가능
3. **최소 입력**: 터치 횟수 최소화
4. **시각적 명확성**: 색상으로 상태 구분 (정상/주의/경고)
5. **인천공항 경보체계 연동**: BLUE/YELLOW/ORANGE/RED 색상 체계

### 5.2 색상 체계 (다크 테마 기본)
| 용도 | 색상 | Hex |
|------|------|-----|
| 배경 (Primary) | 다크 네이비 | #1a1a2e |
| 배경 (Secondary) | 딥 블루 | #16213e |
| 강조 | 코랄 핑크 | #e94560 |
| 경보-BLUE | 블루 | #3b82f6 |
| 경보-YELLOW | 옐로우 | #fbbf24 |
| 경보-ORANGE | 오렌지 | #f97316 |
| 경보-RED | 레드 | #ef4444 |
| 정상 | 그린 | #4ade80 |
| 텍스트 | 라이트 그레이 | #e0e0e0 |

### 5.3 화면 구성 (모바일 기준)

#### 메인 대시보드
```
┌─────────────────────────┐
│ ☰  Immigration QM   ⚙️  │  ← 헤더 (고정)
├─────────────────────────┤
│ ┌─────────────────────┐ │
│ │  📅 2024-01-15 (화) │ │  ← 날짜 선택
│ │  T1 제1여객터미널   │ │
│ └─────────────────────┘ │
├─────────────────────────┤
│ ┌─────────────────────┐ │
│ │ 🔴 08:00 피크 예상  │ │
│ │ 입국 4,573명 → 8명  │ │  ← 요약 카드
│ │ 출국 5,970명 → 10명 │ │
│ └─────────────────────┘ │
├─────────────────────────┤
│                         │
│   [시간대별 차트]       │  ← 터치로 상세 보기
│   ████████░░ 08:00     │
│   ██████████ 09:00     │
│                         │
├─────────────────────────┤
│ ┌───┐ ┌───┐ ┌───┐ ┌───┐│
│ │입국│ │출국│ │설정│ │데이││  ← 하단 탭 바
│ │   │ │   │ │   │ │터 ││
│ └───┘ └───┘ └───┘ └───┘│
└─────────────────────────┘
```

#### 구역별 상세 화면
```
┌─────────────────────────┐
│ ←  입국장 상세          │
├─────────────────────────┤
│ 08:00 ~ 09:00           │
├─────────────────────────┤
│ ┌───────────┬─────────┐ │
│ │ A,B 구역  │  1,539명│ │
│ │ 필요 인원 │    3명  │ │
│ └───────────┴─────────┘ │
│ ┌───────────┬─────────┐ │
│ │ C 구역    │   348명 │ │
│ │ 필요 인원 │    1명  │ │
│ └───────────┴─────────┘ │
│ ┌───────────┬─────────┐ │
│ │ D 구역    │   352명 │ │
│ │ 필요 인원 │    1명  │ │
│ └───────────┴─────────┘ │
│ ┌───────────┬─────────┐ │
│ │ E,F 구역  │  2,334명│ │
│ │ 필요 인원 │    4명  │ │
│ └───────────┴─────────┘ │
├─────────────────────────┤
│ 합계: 4,573명 / 9명 필요│
└─────────────────────────┘
```

#### 데이터 입력 화면
```
┌─────────────────────────┐
│ ←  승객 예고 데이터     │
├─────────────────────────┤
│ ┌─────────────────────┐ │
│ │ 📁 파일 불러오기    │ │
│ └─────────────────────┘ │
│ ┌─────────────────────┐ │
│ │ 📋 샘플 데이터 사용 │ │
│ └─────────────────────┘ │
├─────────────────────────┤
│ 또는 직접 입력:         │
│                         │
│ 시간 | 입국합계 | 출국합계│
│ ┌────┬────────┬────────┐│
│ │00시│   541  │   724  ││
│ ├────┼────────┼────────┤│
│ │01시│   510  │   126  ││
│ ├────┼────────┼────────┤│
│ │... │  ...   │  ...   ││
│ └────┴────────┴────────┘│
│                         │
│ ┌─────────────────────┐ │
│ │     데이터 저장      │ │
│ └─────────────────────┘ │
└─────────────────────────┘
```

---

## 6. 데이터 요구사항

### 6.1 클라이언트 저장 데이터 (LocalStorage/IndexedDB)

#### 승객 예고 데이터
```json
{
  "passengerForecast": {
    "date": "2024-01-15",
    "terminal": "T1",
    "lastUpdated": "2024-01-14T17:00:00",
    "hourlyData": [
      {
        "hour": "00~01",
        "arrival": {
          "AB": 541,
          "C": 0,
          "D": 0,
          "EF": 0,
          "total": 541
        },
        "departure": {
          "12": 0,
          "3": 724,
          "4": 0,
          "56": 0,
          "total": 724
        }
      }
    ]
  }
}
```

#### 계산된 필요 인원
```json
{
  "staffRequirement": {
    "date": "2024-01-15",
    "calculatedAt": "2024-01-14T18:30:00",
    "parameters": {
      "serviceRate": 60,
      "targetUtilization": 0.85,
      "targetWaitTime": 15
    },
    "hourlyRequirement": [
      {
        "hour": "07~08",
        "arrival": {
          "AB": 3,
          "C": 1,
          "D": 1,
          "EF": 4,
          "total": 9
        },
        "departure": {
          "12": 4,
          "3": 3,
          "4": 2,
          "56": 3,
          "total": 12
        }
      }
    ]
  }
}
```

#### 설정 데이터
```json
{
  "settings": {
    "serviceRates": {
      "arrivalKorean": 60,
      "arrivalForeign": 40,
      "departureKorean": 70,
      "departureForeign": 50,
      "autoGate": 120
    },
    "targetWaitTime": 15,
    "targetUtilization": 0.85,
    "autoGateRatio": 0.3,
    "theme": "dark",
    "alertThresholds": {
      "blue": 7000,
      "yellow": 7600,
      "orange": 8200,
      "red": 8600
    }
  }
}
```

### 6.2 기준 데이터 (내장)
- 인천공항 경보 기준값
- 기본 심사 처리 속도
- 구역별 특성 (내국인/외국인 비율 등)

---

## 7. 기술 스택

### 7.1 Phase 1 (MVP) - 순수 프론트엔드
| 구분 | 기술 |
|------|------|
| 마크업 | HTML5 |
| 스타일 | CSS3 (CSS Variables, Flexbox, Grid) |
| 스크립트 | Vanilla JavaScript (ES6+) |
| 차트 | Chart.js |
| 저장소 | LocalStorage, IndexedDB |
| PWA | Service Worker, Web App Manifest |

### 7.2 Phase 2-3 (확장)
| 구분 | 기술 |
|------|------|
| 프론트엔드 | 동일 (또는 React/Vue 마이그레이션) |
| 백엔드 | Python FastAPI |
| 데이터베이스 | PostgreSQL |
| 스크래핑 | BeautifulSoup / Playwright |
| 실시간 | WebSocket |
| 배포 | Vercel / Netlify (정적) → AWS/GCP (서버) |

---

## 8. 성공 지표 (KPI)

| 지표 | 목표 |
|------|------|
| 모바일 사용률 | 전체 사용의 70% 이상 |
| 평균 대기시간 | 기존 대비 20% 감소 |
| 심사관 활용률 | 70~85% 유지 |
| 줄반장 업무시간 | 예측/배치 결정 시간 50% 감소 |
| 배치 정확도 | 권장 인원 대비 실제 배치 ±1명 이내 |
| 앱 로딩 시간 | 3초 이내 (3G) |
| Lighthouse 점수 | Performance 90+, PWA 100 |

---

## 9. 개발 로드맵

### Phase 1: MVP (4주)
- **Week 1**: 프로젝트 셋업, 기본 HTML/CSS 구조, 반응형 레이아웃
- **Week 2**: 데이터 입력/저장, 인천공항 데이터 포맷 처리
- **Week 3**: 필요 인원 계산 엔진, 대기행렬 모델 구현
- **Week 4**: 차트 시각화, PWA 설정, 테스트

### Phase 2: 근무표 (4주)
- **Week 1-2**: 심사관 관리, 근무표 UI
- **Week 3-4**: 자동 배치 알고리즘, 실시간 대시보드

### Phase 3: 서버 연동 (4주)
- **Week 1**: 백엔드 API 개발
- **Week 2**: 인천공항 데이터 자동 수집
- **Week 3-4**: 실시간 동기화, 배포

---

## 10. 위험 요소 및 대응

| 위험 | 영향 | 대응 |
|------|------|------|
| 인천공항 웹페이지 구조 변경 | 높음 | 수동 입력 대체 기능, 크롤러 유지보수 |
| 모바일 성능 이슈 | 중간 | 계산 최적화, Web Worker 활용 |
| 오프라인 데이터 충돌 | 중간 | 명확한 동기화 정책, 충돌 해결 UI |
| 예측 정확도 한계 | 중간 | 실측 데이터 피드백 루프, 보정 계수 |

---

## 부록 A: 용어 정의

| 용어 | 정의 |
|------|------|
| 줄반장 | 출입국 심사장에서 심사관 배치를 담당하는 관리자 |
| λ(t) | 시간 t에서의 단위시간당 승객 도착률 (람다) |
| μ | 심사관 1명의 단위시간당 처리 능력 (뮤) |
| c(t) | 시간 t에서 필요한 심사관 수 |
| ρ | 활용률 (λ / cμ) |
| PWA | Progressive Web App - 앱처럼 동작하는 웹 |
| T1/T2 | 인천공항 제1/제2 여객터미널 |

## 부록 B: 인천공항 구역 정보

### 제1 여객터미널
| 구분 | 구역 | 특성 |
|------|------|------|
| 입국 | A,B | - |
| 입국 | C | - |
| 입국 | D | - |
| 입국 | E,F | - |
| 출국 | 1,2 | 1번은 교통약자 우대출구 (혼잡도 제외) |
| 출국 | 3 | - |
| 출국 | 4 | - |
| 출국 | 5,6 | 6번은 교통약자 우대출구 (혼잡도 제외) |

## 부록 C: 참고 자료

- 인천공항 공항 예상혼잡도: https://www.airport.kr/ap_ko/883/subview.do
- 인천공항 고객센터: 1577-2600
- T1 출국장 대기시간 데이터: 운영DX팀 032-741-2501
- 출국 승객 예고: 통합운영센터 상황실 032-741-2961
